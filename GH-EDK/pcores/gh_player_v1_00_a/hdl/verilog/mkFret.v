//
// Generated by Bluespec Compiler, version 2012.01.A (build 26572, 2012-01-17)
//
// On Wed Apr 24 12:17:57 BST 2013
//
// Method conflict info:
// Method: vsync
// Conflict-free: hsync, vde, rgb, xPos, yPos, trigUp, trigDown, press
// Conflicts: vsync
//
// Method: hsync
// Conflict-free: vsync, vde, rgb, xPos, yPos, trigUp, trigDown, press
// Conflicts: hsync
//
// Method: vde
// Conflict-free: vsync, hsync, rgb, xPos, yPos, trigUp, trigDown, press
// Conflicts: vde
//
// Method: rgb
// Conflict-free: vsync, hsync, vde, xPos, yPos, trigUp, trigDown, press
// Conflicts: rgb
//
// Method: xPos
// Conflict-free: vsync, hsync, vde, rgb, yPos, trigUp, trigDown, press
// Conflicts: xPos
//
// Method: yPos
// Conflict-free: vsync, hsync, vde, rgb, xPos, trigUp, trigDown, press
// Conflicts: yPos
//
// Method: trigUp
// Conflict-free: vsync, hsync, vde, rgb, xPos, yPos, trigDown, press
// Conflicts: trigUp
//
// Method: trigDown
// Conflict-free: vsync, hsync, vde, rgb, xPos, yPos, trigUp, press
// Conflicts: trigDown
//
// Method: press
// Conflict-free: vsync, hsync, vde, rgb, xPos, yPos, trigUp, trigDown, press
//
//
// Ports:
// Name                         I/O  size props
// press                          O     1 reg
// CLK                            I     1 clock
// RST_N                          I     1 reset
// rgb_pixel                      I    24
// xPos_val                       I    11
// yPos_val                       I    10
// trigUp_val                     I    24
// trigDown_val                   I    24
// vsync                          I     1
// hsync                          I     1
// vde                            I     1
//
// No combinational paths from inputs to outputs
//
//

`ifdef BSV_ASSIGNMENT_DELAY
`else
`define BSV_ASSIGNMENT_DELAY
`endif

module mkFret(CLK,
	      RST_N,

	      vsync,

	      hsync,

	      vde,

	      rgb_pixel,

	      xPos_val,

	      yPos_val,

	      trigUp_val,

	      trigDown_val,

	      press);
  parameter [1 : 0] lOffset = 2'b0;
  parameter [1 : 0] rOffset = 2'b0;
  input  CLK;
  input  RST_N;

  // action method vsync
  input  vsync;

  // action method hsync
  input  hsync;

  // action method vde
  input  vde;

  // action method rgb
  input  [23 : 0] rgb_pixel;

  // action method xPos
  input  [10 : 0] xPos_val;

  // action method yPos
  input  [9 : 0] yPos_val;

  // action method trigUp
  input  [23 : 0] trigUp_val;

  // action method trigDown
  input  [23 : 0] trigDown_val;

  // value method press
  output press;

  // signals for module outputs
  wire press;

  // inlined wires
  wire [10 : 0] xPos1$wget,
		xPos2$wget,
		xPos3$wget,
		xPos4$wget,
		xPos5$wget,
		xPos6$wget,
		xPos7$wget;
  wire [9 : 0] yPos1$wget, yPos3$wget;

  // register fretPressed
  reg fretPressed;
  wire fretPressed$D_IN, fretPressed$EN;

  // register fretPressedDly
  reg fretPressedDly;
  wire fretPressedDly$D_IN, fretPressedDly$EN;

  // register fretValues
  reg fretValues;
  wire fretValues$D_IN, fretValues$EN;

  // register fretValues_1
  reg fretValues_1;
  wire fretValues_1$D_IN, fretValues_1$EN;

  // register fretValues_2
  reg fretValues_2;
  wire fretValues_2$D_IN, fretValues_2$EN;

  // register fretValues_3
  reg fretValues_3;
  wire fretValues_3$D_IN, fretValues_3$EN;

  // register fretValues_4
  reg fretValues_4;
  wire fretValues_4$D_IN, fretValues_4$EN;

  // register fretValues_5
  reg fretValues_5;
  wire fretValues_5$D_IN, fretValues_5$EN;

  // register fretValues_6
  reg fretValues_6;
  wire fretValues_6$D_IN, fretValues_6$EN;

  // register x
  reg [10 : 0] x;
  wire [10 : 0] x$D_IN;
  wire x$EN;

  // register y
  reg [9 : 0] y;
  wire [9 : 0] y$D_IN;
  wire y$EN;

  // rule scheduling signals
  wire WILL_FIRE_RL_fret_off,
       WILL_FIRE_RL_new_line,
       WILL_FIRE_RL_new_pixel,
       WILL_FIRE_RL_start_pixel1,
       WILL_FIRE_RL_start_pixel2,
       WILL_FIRE_RL_start_pixel3,
       WILL_FIRE_RL_start_pixel4,
       WILL_FIRE_RL_start_pixel5,
       WILL_FIRE_RL_start_pixel6,
       WILL_FIRE_RL_start_pixel7;

  // inputs to muxes for submodule ports
  wire [10 : 0] MUX_x$write_1__VAL_1;
  wire [9 : 0] MUX_y$write_1__VAL_1;
  wire MUX_fretValues$write_1__VAL_1,
       MUX_fretValues$write_1__VAL_2,
       MUX_x$write_1__SEL_2;

  // remaining internal signals
  wire x_8_EQ_xPos1_wget__1_2_AND_y_2_EQ_yPos1_wget___ETC___d151,
       x_8_EQ_xPos2_wget__7_8_AND_y_2_EQ_yPos1_wget___ETC___d167,
       x_8_EQ_xPos3_wget__9_0_AND_y_2_EQ_yPos2_wget___ETC___d174,
       x_8_EQ_xPos4_wget__01_02_AND_y_2_EQ_yPos2_wget_ETC___d179,
       x_8_EQ_xPos5_wget__11_12_AND_y_2_EQ_yPos2_wget_ETC___d184,
       x_8_EQ_xPos6_wget__23_24_AND_y_2_EQ_yPos3_wget_ETC___d191,
       x_8_EQ_xPos7_wget__35_36_AND_y_2_EQ_yPos3_wget_ETC___d196,
       y_2_EQ_yPos1_wget__3___d54,
       y_2_EQ_yPos2_wget__1___d92,
       y_2_EQ_yPos3_wget__25___d126;

  // value method press
  assign press = fretPressedDly ;

  // rule RL_fret_off
  assign WILL_FIRE_RL_fret_off = !fretPressed && fretPressedDly && vsync ;

  // rule RL_start_pixel1
  assign WILL_FIRE_RL_start_pixel1 =
	     x == xPos1$wget && y_2_EQ_yPos1_wget__3___d54 && !fretPressed &&
	     !vsync ;

  // rule RL_start_pixel2
  assign WILL_FIRE_RL_start_pixel2 =
	     x == xPos2$wget && y_2_EQ_yPos1_wget__3___d54 && !fretPressed &&
	     !vsync ;

  // rule RL_start_pixel3
  assign WILL_FIRE_RL_start_pixel3 =
	     x == xPos3$wget && y_2_EQ_yPos2_wget__1___d92 && !fretPressed &&
	     !vsync ;

  // rule RL_start_pixel4
  assign WILL_FIRE_RL_start_pixel4 =
	     x == xPos4$wget && y_2_EQ_yPos2_wget__1___d92 && !fretPressed &&
	     !vsync ;

  // rule RL_start_pixel5
  assign WILL_FIRE_RL_start_pixel5 =
	     x == xPos5$wget && y_2_EQ_yPos2_wget__1___d92 && !fretPressed &&
	     !vsync ;

  // rule RL_start_pixel6
  assign WILL_FIRE_RL_start_pixel6 =
	     x == xPos6$wget && y_2_EQ_yPos3_wget__25___d126 &&
	     !fretPressed &&
	     !vsync ;

  // rule RL_start_pixel7
  assign WILL_FIRE_RL_start_pixel7 =
	     x == xPos7$wget && y_2_EQ_yPos3_wget__25___d126 &&
	     !fretPressed &&
	     !vsync ;

  // rule RL_new_line
  assign WILL_FIRE_RL_new_line = hsync && !vsync && x != 11'd0 ;

  // rule RL_new_pixel
  assign WILL_FIRE_RL_new_pixel = vde && !hsync && !vsync ;

  // inputs to muxes for submodule ports
  assign MUX_x$write_1__SEL_2 = WILL_FIRE_RL_new_line || vsync ;
  assign MUX_fretValues$write_1__VAL_1 =
	     rgb_pixel[23:16] >= trigUp_val[23:16] &&
	     rgb_pixel[15:8] >= trigUp_val[15:8] &&
	     rgb_pixel[7:0] >= trigUp_val[7:0] ;
  assign MUX_fretValues$write_1__VAL_2 =
	     rgb_pixel[23:16] >= trigDown_val[23:16] ||
	     rgb_pixel[15:8] >= trigDown_val[15:8] ||
	     rgb_pixel[7:0] >= trigDown_val[7:0] ;
  assign MUX_x$write_1__VAL_1 = x + 11'd1 ;
  assign MUX_y$write_1__VAL_1 = y + 10'd1 ;

  // inlined wires
  assign xPos1$wget = xPos_val - 11'd5 ;
  assign xPos2$wget = xPos_val - 11'd3 ;
  assign xPos3$wget = xPos_val - 11'd1 ;
  assign xPos4$wget = xPos_val + 11'd1 ;
  assign xPos5$wget = xPos_val + 11'd3 ;
  assign xPos6$wget = xPos_val + 11'd5 ;
  assign xPos7$wget = xPos_val + 11'd7 ;
  assign yPos1$wget = yPos_val + { 8'd0, lOffset } - 10'd1 ;
  assign yPos3$wget = yPos_val + { 8'd0, rOffset } - 10'd1 ;

  // register fretPressed
  assign fretPressed$D_IN =
	     fretValues || fretValues_1 || fretValues_2 || fretValues_3 ||
	     fretValues_4 ||
	     fretValues_5 ||
	     fretValues_6 ;
  assign fretPressed$EN = vsync ;

  // register fretPressedDly
  assign fretPressedDly$D_IN = !WILL_FIRE_RL_fret_off ;
  assign fretPressedDly$EN =
	     WILL_FIRE_RL_fret_off || fretPressed && !fretPressedDly ;

  // register fretValues
  assign fretValues$D_IN =
	     WILL_FIRE_RL_start_pixel1 ?
	       MUX_fretValues$write_1__VAL_1 :
	       MUX_fretValues$write_1__VAL_2 ;
  assign fretValues$EN =
	     WILL_FIRE_RL_start_pixel1 ||
	     x_8_EQ_xPos1_wget__1_2_AND_y_2_EQ_yPos1_wget___ETC___d151 &&
	     !vsync ;

  // register fretValues_1
  assign fretValues_1$D_IN =
	     WILL_FIRE_RL_start_pixel2 ?
	       MUX_fretValues$write_1__VAL_1 :
	       MUX_fretValues$write_1__VAL_2 ;
  assign fretValues_1$EN =
	     WILL_FIRE_RL_start_pixel2 ||
	     x_8_EQ_xPos2_wget__7_8_AND_y_2_EQ_yPos1_wget___ETC___d167 &&
	     !vsync ;

  // register fretValues_2
  assign fretValues_2$D_IN =
	     WILL_FIRE_RL_start_pixel3 ?
	       MUX_fretValues$write_1__VAL_1 :
	       MUX_fretValues$write_1__VAL_2 ;
  assign fretValues_2$EN =
	     WILL_FIRE_RL_start_pixel3 ||
	     x_8_EQ_xPos3_wget__9_0_AND_y_2_EQ_yPos2_wget___ETC___d174 &&
	     !vsync ;

  // register fretValues_3
  assign fretValues_3$D_IN =
	     WILL_FIRE_RL_start_pixel4 ?
	       MUX_fretValues$write_1__VAL_1 :
	       MUX_fretValues$write_1__VAL_2 ;
  assign fretValues_3$EN =
	     WILL_FIRE_RL_start_pixel4 ||
	     x_8_EQ_xPos4_wget__01_02_AND_y_2_EQ_yPos2_wget_ETC___d179 &&
	     !vsync ;

  // register fretValues_4
  assign fretValues_4$D_IN =
	     WILL_FIRE_RL_start_pixel5 ?
	       MUX_fretValues$write_1__VAL_1 :
	       MUX_fretValues$write_1__VAL_2 ;
  assign fretValues_4$EN =
	     WILL_FIRE_RL_start_pixel5 ||
	     x_8_EQ_xPos5_wget__11_12_AND_y_2_EQ_yPos2_wget_ETC___d184 &&
	     !vsync ;

  // register fretValues_5
  assign fretValues_5$D_IN =
	     WILL_FIRE_RL_start_pixel6 ?
	       MUX_fretValues$write_1__VAL_1 :
	       MUX_fretValues$write_1__VAL_2 ;
  assign fretValues_5$EN =
	     WILL_FIRE_RL_start_pixel6 ||
	     x_8_EQ_xPos6_wget__23_24_AND_y_2_EQ_yPos3_wget_ETC___d191 &&
	     !vsync ;

  // register fretValues_6
  assign fretValues_6$D_IN =
	     WILL_FIRE_RL_start_pixel7 ?
	       MUX_fretValues$write_1__VAL_1 :
	       MUX_fretValues$write_1__VAL_2 ;
  assign fretValues_6$EN =
	     WILL_FIRE_RL_start_pixel7 ||
	     x_8_EQ_xPos7_wget__35_36_AND_y_2_EQ_yPos3_wget_ETC___d196 &&
	     !vsync ;

  // register x
  assign x$D_IN = WILL_FIRE_RL_new_pixel ? MUX_x$write_1__VAL_1 : 11'd0 ;
  assign x$EN = WILL_FIRE_RL_new_pixel || WILL_FIRE_RL_new_line || vsync ;

  // register y
  assign y$D_IN = WILL_FIRE_RL_new_line ? MUX_y$write_1__VAL_1 : 10'd0 ;
  assign y$EN = MUX_x$write_1__SEL_2 ;

  // remaining internal signals
  assign x_8_EQ_xPos1_wget__1_2_AND_y_2_EQ_yPos1_wget___ETC___d151 =
	     x == xPos1$wget && y_2_EQ_yPos1_wget__3___d54 && fretPressed ;
  assign x_8_EQ_xPos2_wget__7_8_AND_y_2_EQ_yPos1_wget___ETC___d167 =
	     x == xPos2$wget && y_2_EQ_yPos1_wget__3___d54 && fretPressed ;
  assign x_8_EQ_xPos3_wget__9_0_AND_y_2_EQ_yPos2_wget___ETC___d174 =
	     x == xPos3$wget && y_2_EQ_yPos2_wget__1___d92 && fretPressed ;
  assign x_8_EQ_xPos4_wget__01_02_AND_y_2_EQ_yPos2_wget_ETC___d179 =
	     x == xPos4$wget && y_2_EQ_yPos2_wget__1___d92 && fretPressed ;
  assign x_8_EQ_xPos5_wget__11_12_AND_y_2_EQ_yPos2_wget_ETC___d184 =
	     x == xPos5$wget && y_2_EQ_yPos2_wget__1___d92 && fretPressed ;
  assign x_8_EQ_xPos6_wget__23_24_AND_y_2_EQ_yPos3_wget_ETC___d191 =
	     x == xPos6$wget && y_2_EQ_yPos3_wget__25___d126 && fretPressed ;
  assign x_8_EQ_xPos7_wget__35_36_AND_y_2_EQ_yPos3_wget_ETC___d196 =
	     x == xPos7$wget && y_2_EQ_yPos3_wget__25___d126 && fretPressed ;
  assign y_2_EQ_yPos1_wget__3___d54 = y == yPos1$wget ;
  assign y_2_EQ_yPos2_wget__1___d92 = y == yPos_val ;
  assign y_2_EQ_yPos3_wget__25___d126 = y == yPos3$wget ;

  // handling of inlined registers

  always@(posedge CLK)
  begin
    if (!RST_N)
      begin
        fretPressed <= `BSV_ASSIGNMENT_DELAY 1'd0;
	fretPressedDly <= `BSV_ASSIGNMENT_DELAY 1'd0;
	fretValues <= `BSV_ASSIGNMENT_DELAY 1'd0;
	fretValues_1 <= `BSV_ASSIGNMENT_DELAY 1'd0;
	fretValues_2 <= `BSV_ASSIGNMENT_DELAY 1'd0;
	fretValues_3 <= `BSV_ASSIGNMENT_DELAY 1'd0;
	fretValues_4 <= `BSV_ASSIGNMENT_DELAY 1'd0;
	fretValues_5 <= `BSV_ASSIGNMENT_DELAY 1'd0;
	fretValues_6 <= `BSV_ASSIGNMENT_DELAY 1'd0;
	x <= `BSV_ASSIGNMENT_DELAY 11'd0;
	y <= `BSV_ASSIGNMENT_DELAY 10'd0;
      end
    else
      begin
        if (fretPressed$EN)
	  fretPressed <= `BSV_ASSIGNMENT_DELAY fretPressed$D_IN;
	if (fretPressedDly$EN)
	  fretPressedDly <= `BSV_ASSIGNMENT_DELAY fretPressedDly$D_IN;
	if (fretValues$EN)
	  fretValues <= `BSV_ASSIGNMENT_DELAY fretValues$D_IN;
	if (fretValues_1$EN)
	  fretValues_1 <= `BSV_ASSIGNMENT_DELAY fretValues_1$D_IN;
	if (fretValues_2$EN)
	  fretValues_2 <= `BSV_ASSIGNMENT_DELAY fretValues_2$D_IN;
	if (fretValues_3$EN)
	  fretValues_3 <= `BSV_ASSIGNMENT_DELAY fretValues_3$D_IN;
	if (fretValues_4$EN)
	  fretValues_4 <= `BSV_ASSIGNMENT_DELAY fretValues_4$D_IN;
	if (fretValues_5$EN)
	  fretValues_5 <= `BSV_ASSIGNMENT_DELAY fretValues_5$D_IN;
	if (fretValues_6$EN)
	  fretValues_6 <= `BSV_ASSIGNMENT_DELAY fretValues_6$D_IN;
	if (x$EN) x <= `BSV_ASSIGNMENT_DELAY x$D_IN;
	if (y$EN) y <= `BSV_ASSIGNMENT_DELAY y$D_IN;
      end
  end

  // synopsys translate_off
  `ifdef BSV_NO_INITIAL_BLOCKS
  `else // not BSV_NO_INITIAL_BLOCKS
  initial
  begin
    fretPressed = 1'h0;
    fretPressedDly = 1'h0;
    fretValues = 1'h0;
    fretValues_1 = 1'h0;
    fretValues_2 = 1'h0;
    fretValues_3 = 1'h0;
    fretValues_4 = 1'h0;
    fretValues_5 = 1'h0;
    fretValues_6 = 1'h0;
    x = 11'h2AA;
    y = 10'h2AA;
  end
  `endif // BSV_NO_INITIAL_BLOCKS
  // synopsys translate_on
endmodule  // mkFret

